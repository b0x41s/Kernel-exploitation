#!/bin/sh

mknod -m 666 /dev/null c 1 3
mknod -m 666 /dev/zero c 1 5
mknod -m 666 /dev/ptmx c 5 2
mknod -m 666 /dev/tty c 5 0
mknod -m 0660 /dev/ttyS0 c 4 64
mknod -m 444 /dev/random c 1 8
mknod -m 444 /dev/urandom c 1 9
chown root:tty /dev/console
chown root:tty /dev/ptmx
chown root:tty /dev/tty
mkdir -p /dev/pts
mount -vt devpts -o gid=4,mode=620 none /dev/pts

mount -t proc none /proc
mount -t sysfs none /sys

mkdir /tmptwo

sysctl -w kernel.perf_event_paranoid=0
sysctl -w kernel.dmesg_restrict=0
sysctl -w kernel.kptr_restrict=0

clear

cat <<EOF

K)   kk  R)rrrrr   O)oooo    C)ccc  K)   kk      2)AAA  
K)  kk   R)    rr O)    oo  C)   cc K)  kk      2)   AA 
K)kkk    R)  rrr  O)    oo C)       K)kkk           2)  
K)  kk   R) rr    O)    oo C)       K)  kk         2)   
K)   kk  R)   rr  O)    oo  C)   cc K)   kk       2)    
K)    kk R)    rr  O)oooo    C)ccc  K)    kk    2)AAAAA 
                                                        
                                                        

EOF

insmod krock_two.ko
mknod /dev/krock_two c 248 0
chmod 777 /dev/krock_two

mkdir /tmp
chown 1000.1000 /tmp
chown -R 1000.1000 /home/
chmod 600 /flag
chown 0.0 /flag

setsid cttyhack setuidgid 1000 sh
